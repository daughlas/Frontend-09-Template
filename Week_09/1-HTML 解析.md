学习笔记

真正的浏览器逐段返回 body ，逐段去 parse

## || 第一步 模块化
* 为了方便文件管理，parser 单独成一个文件
* parser 接受 HTML 文本作为参数，返回一颗 DOM 树

## || 第二步 用 FSM 分析 HTML
* 利用 FSM 来实现 HTML 分析
* 利用 HTML 标准中规定好的状态，[标准](https://html.spec.whatwg.org/multipage/) 中的 Tokenization 章节
* 只实现 80 多个状态中的一部分


## || 第三步 解析标签
* 标签分
    * 开始标签
    * 结束标签
    * 自封闭标签

## || 第四步 创建元素
* 在状态机中，在状态迁移的同时，加上业务逻辑
* 创建token
* 在标签结束状态提交 emit token

## || 第五步 处理属性
* 属性值氛围单引号、双引号、无引号三种写法，都需要单独处理
* 处理属性的方式与处理标签类似，用 currentAttribute 暂存
* 属性结束时，把属性 emit currentToken，就带上了 currentAttribute

## || 第六步 用 Token 构建 DOM 树
* 从标签构建 DOM 树，需要使用栈
* 遇到开始标签入栈，遇到结束标签出栈
* 自封闭节点可视为入栈后立刻出栈
* 任何元素的氟元素都是它入栈前的栈顶元素

## || 第七步 文本节点
* 文本节点不会入栈，添加到当前栈顶元素的子元素中
* 多个文本节点需要合并


